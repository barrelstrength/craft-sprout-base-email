{% requirePermission viewNotificationsPermission %}

{% extends "sprout-base-email/_layouts/elementindex" %}

{% set title = "Notification Email"|t('sprout-base-email') %}
{% set elementType = 'barrelstrength\\sproutbaseemail\\elements\\NotificationEmail' %}

{% block actionButton %}
    <div class="buttons">
        <a class="btn submit add icon"
            href="{{ cpUrl(notificationEmailBaseUrl ~ 'edit/new') }}">
            {{ "New Notification"|t('sprout-base-email') }}
        </a>
    </div>
{% endblock %}

{% block content %}

    {{ parent() }}

    {% include "sprout-base-email/_modals/base" %}

{% endblock %}

{% block initJs %}
    // Pass segment to the NotificationEmailQuery class to filter notification entries
    var criteria = $.extend({}, Craft.defaultIndexCriteria);
    criteria.viewContext = '{{ viewContext }}';
    criteria.notificationEmailBaseUrl = '{{ notificationEmailBaseUrl }}';

    Craft.elementIndex = Craft.createElementIndex('{{ elementType|e("js") }}', $('#page-container'), {
    elementTypeName: '{{ elementInstance.displayName()|e("js") }}',
    elementTypePluralName: '{{ elementInstance.pluralDisplayName()|e("js") }}',
    context: '{{ context }}',
    storageKey: 'elementindex.{{ elementType|e("js") }}',
    criteria: criteria,
    toolbarSelector: '#toolbar',
    hideSidebar: '{{ hideSidebar ?? false }}'
    });

    {% if hideSidebar %}
        $('#sidebar-toggle-container').remove();
        $('#sidebar-container').remove();
    {% endif %}

{% endblock %}
